<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.299">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data-Based Economics - Short Intro to Language Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../session_1/index.html">Handouts</a></li><li class="breadcrumb-item"><a href="../ai/index.html">Short Intro to Language Models</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data-Based Economics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Handouts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataframes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_6/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Instrumental Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_7/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Machine Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_8/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Machine Learning (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_9/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ai/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Short Intro to Language Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_3/Philips_curve_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Visualizing the Philips Curve using matplotlib and altair</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_4/Regressions_correction_2022.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_6/instrumental_variables_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instrumental variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_7/machine_learning_regressions_correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning: regressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../session_8/Classification_Correction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification and clustering</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-does-gpt-3-do" id="toc-what-does-gpt-3-do" class="nav-link active" data-scroll-target="#what-does-gpt-3-do">What does GPT-3 do?</a>
  <ul class="collapse">
  <li><a href="#do-you-like-poetry" id="toc-do-you-like-poetry" class="nav-link" data-scroll-target="#do-you-like-poetry">Do you like poetry?</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#complete-text" id="toc-complete-text" class="nav-link" data-scroll-target="#complete-text">Complete Text</a></li>
  <li><a href="#gpt3-playground" id="toc-gpt3-playground" class="nav-link" data-scroll-target="#gpt3-playground">GPT3 Playground</a></li>
  <li><a href="#some-examples" id="toc-some-examples" class="nav-link" data-scroll-target="#some-examples">Some Examples</a></li>
  </ul></li>
  <li><a href="#how-does-it-do-it" id="toc-how-does-it-do-it" class="nav-link" data-scroll-target="#how-does-it-do-it">How does it do it?</a>
  <ul class="collapse">
  <li><a href="#language-models-and-cryptography" id="toc-language-models-and-cryptography" class="nav-link" data-scroll-target="#language-models-and-cryptography">Language Models and Cryptography</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#monte-carlo-markov-chains" id="toc-monte-carlo-markov-chains" class="nav-link" data-scroll-target="#monte-carlo-markov-chains">Monte Carlo Markov Chains</a></li>
  <li><a href="#mcmc-to-generate-text" id="toc-mcmc-to-generate-text" class="nav-link" data-scroll-target="#mcmc-to-generate-text">MCMC to generate text</a></li>
  <li><a href="#mcmc-to-generate-text-1" id="toc-mcmc-to-generate-text-1" class="nav-link" data-scroll-target="#mcmc-to-generate-text-1">MCMC to generate text</a></li>
  <li><a href="#big-mcmc" id="toc-big-mcmc" class="nav-link" data-scroll-target="#big-mcmc">Big MCMC</a></li>
  <li><a href="#reccurrent-neural-networks" id="toc-reccurrent-neural-networks" class="nav-link" data-scroll-target="#reccurrent-neural-networks">Reccurrent Neural Networks</a></li>
  <li><a href="#recurrent-neural-networks" id="toc-recurrent-neural-networks" class="nav-link" data-scroll-target="#recurrent-neural-networks">Recurrent Neural Networks</a></li>
  <li><a href="#long-short-term-memory" id="toc-long-short-term-memory" class="nav-link" data-scroll-target="#long-short-term-memory">Long Short Term Memory</a></li>
  <li><a href="#the-latest-transformer" id="toc-the-latest-transformer" class="nav-link" data-scroll-target="#the-latest-transformer">The Latest: Transformer</a></li>
  <li><a href="#quick-summary" id="toc-quick-summary" class="nav-link" data-scroll-target="#quick-summary">Quick summary</a></li>
  <li><a href="#gpt3" id="toc-gpt3" class="nav-link" data-scroll-target="#gpt3">GPT3</a></li>
  <li><a href="#corpus" id="toc-corpus" class="nav-link" data-scroll-target="#corpus">Corpus</a></li>
  <li><a href="#chat-gpt" id="toc-chat-gpt" class="nav-link" data-scroll-target="#chat-gpt">Chat GPT</a></li>
  <li><a href="#the-relation-between-gpt-3-and-chatgpt" id="toc-the-relation-between-gpt-3-and-chatgpt" class="nav-link" data-scroll-target="#the-relation-between-gpt-3-and-chatgpt">The Relation between GPT-3 and ChatGPT</a></li>
  </ul></li>
  <li><a href="#how-can-we-use-gpt3" id="toc-how-can-we-use-gpt3" class="nav-link" data-scroll-target="#how-can-we-use-gpt3">How can we use GPT3</a>
  <ul class="collapse">
  <li><a href="#generate-text" id="toc-generate-text" class="nav-link" data-scroll-target="#generate-text">Generate Text</a></li>
  <li><a href="#the-quality-of-the-generated-text" id="toc-the-quality-of-the-generated-text" class="nav-link" data-scroll-target="#the-quality-of-the-generated-text">The quality of the generated text</a></li>
  <li><a href="#ethical-concerns" id="toc-ethical-concerns" class="nav-link" data-scroll-target="#ethical-concerns">Ethical Concerns</a></li>
  <li><a href="#replace-many-nlp-algorithms" id="toc-replace-many-nlp-algorithms" class="nav-link" data-scroll-target="#replace-many-nlp-algorithms">Replace Many NLP Algorithms</a></li>
  <li><a href="#named-entity-recognition" id="toc-named-entity-recognition" class="nav-link" data-scroll-target="#named-entity-recognition">Named Entity recognition</a></li>
  <li><a href="#fine-tuning-1" id="toc-fine-tuning-1" class="nav-link" data-scroll-target="#fine-tuning-1">Fine-tuning (1)</a></li>
  <li><a href="#fine-tuning-2" id="toc-fine-tuning-2" class="nav-link" data-scroll-target="#fine-tuning-2">Fine-tuning (2)</a></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis">Sentiment Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a>
  <ul class="collapse">
  <li><a href="#are-we-on-the-way-to-general-artificial-intelligence" id="toc-are-we-on-the-way-to-general-artificial-intelligence" class="nav-link" data-scroll-target="#are-we-on-the-way-to-general-artificial-intelligence">Are we on the way to General Artificial Intelligence?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Short Intro to Language Models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="what-does-gpt-3-do" class="level1">
<h1>What does GPT-3 do?</h1>
<section id="do-you-like-poetry" class="level2">
<h2 class="anchored" data-anchor-id="do-you-like-poetry">Do you like poetry?</h2>
<p>. . .</p>
<blockquote class="blockquote">
<p>A rose is a rose is <span class="fragment">a rose</span></p>
</blockquote>
<p>. . .</p>
<pre><code>Gertrude Stein</code></pre>
<p>. . .</p>
<blockquote class="blockquote">
<p>Brexit means Brexit means <span class="fragment">Brexit</span></p>
</blockquote>
<p>. . .</p>
<pre><code>John Crace</code></pre>
<p>. . .</p>
<blockquote class="blockquote">
<p>Elementary my dear <span class="fragment">Watson</span></p>
</blockquote>
<p>. . .</p>
<pre><code>P.G. Woodehouse</code></pre>
<p>. . .</p>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<blockquote class="blockquote">
<p>There is an easy way for the government to end the strike without withdrawing the pension reform,</p>
</blockquote>
<p>. . .</p>
</section>
<section id="complete-text" class="level2">
<h2 class="anchored" data-anchor-id="complete-text">Complete Text</h2>
<p>Generative language models perform <em>text completion</em></p>
<p>They generate plausible<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> text following a prompt.</p>
<p>The type of answer, will depend on the kind of prompt.</p>
</section>
<section id="gpt3-playground" class="level2">
<h2 class="anchored" data-anchor-id="gpt3-playground">GPT3 Playground</h2>
<p>To use GPT-3 profficiently, you have to experiment with the prompt.</p>
<ul>
<li>try the <a href="https://platform.openai.com/playground">Playground mode</a></li>
</ul>
<p>It is the same as learning how to do google queries</p>
<ul>
<li>altavista: <code>+noir +film -"pinot noir"</code></li>
<li>nowadays: ???</li>
</ul>
</section>
<section id="some-examples" class="level2">
<h2 class="anchored" data-anchor-id="some-examples">Some Examples</h2>
<p>By providing enough <em>context</em>, it is possible to perform amazing tasks</p>
<p><a href="https://gpt3demo.com/">Look at the demos</a></p>
</section>
</section>
<section id="how-does-it-do-it" class="level1">
<h1>How does it do it?</h1>
<section id="language-models-and-cryptography" class="level2">
<h2 class="anchored" data-anchor-id="language-models-and-cryptography">Language Models and Cryptography</h2>
<p><img src="assets/code-secret.webp" class="img-fluid"></p>
<p>The Caesar code</p>
</section>
<section id="section-1" class="level2" data-auto-animate="true">
<h2 data-auto-animate="true" class="anchored" data-anchor-id="section-1"></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/zodiac_408.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Zodiac 408 Cipher</figcaption><p></p>
</figure>
</div>
</section>
<section id="section-2" class="level2" data-auto-animate="true">
<h2 data-auto-animate="true" class="anchored" data-anchor-id="section-2"></h2>
<div id="fig-elephants" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/zodiac_408.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Zodiac 408 Cipher</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 66.7%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/408_solution.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Key for Zodiac 408</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Solved in a week by Bettye and Donald Harden using frequency tables.</figcaption><p></p>
</figure>
</div>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<p>Later in 2001, in a prison, somewhere in California</p>
<p><img src="assets/prison.png" class="img-fluid"></p>
<p>. . .</p>
<p>Solved by Stanford’s <a href="https://math.uchicago.edu/~shmuel/Network-course-readings/MCMCRev.pdf">Persi Diaconis</a> and his students using Monte Carlo Markov Chains</p>
</section>
<section id="monte-carlo-markov-chains" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-markov-chains">Monte Carlo Markov Chains</h2>
<p>Take a letter <span class="math inline">\(x_n\)</span>, what is the probability of the next letter being <span class="math inline">\(x_{n+1}\)</span>?</p>
<p><span class="math display">\[\pi_{X,Y} = P(x_{n+1}=Y, x_{n}=X)\]</span></p>
<p>for <span class="math inline">\(X=\{a, b, .... , z\} , Y=\{a,b,c, ... z\}\)</span></p>
<p>The language model can be trained using dataset of english language.</p>
<p>And used to determine whether a given cipher-key is consistent with english language.</p>
<p>It yields a very efficient algorithm to decode any caesar code (with very small sample)</p>
</section>
<section id="mcmc-to-generate-text" class="level2">
<h2 class="anchored" data-anchor-id="mcmc-to-generate-text">MCMC to generate text</h2>
<p>MCMCs can also be used to generate text:</p>
<ul>
<li>take initial prompt: <code>I think therefore I</code>
<ul>
<li>last letter is <code>I</code></li>
<li>most plausible character afterwards is <code></code></li>
<li>most plausible character afterwards is <code>I</code></li>
</ul></li>
<li>Result: <code>I think therefore I I I I I I</code></li>
</ul>
<p>Not good but promising (🤷)</p>
</section>
<section id="mcmc-to-generate-text-1" class="level2">
<h2 class="anchored" data-anchor-id="mcmc-to-generate-text-1">MCMC to generate text</h2>
<p>Going further</p>
<ul>
<li>augment memory
<ul>
<li><code>fore I</code>&gt; ???</li>
</ul></li>
<li>change basic unit (use phonems or words)</li>
</ul>
<p>An example using <a href="https://towardsdatascience.com/text-generation-with-markov-chains-an-introduction-to-using-markovify-742e6680dc33">MCMC</a></p>
<ul>
<li>using words and 3 states <code>He ha ‘s kill’d me Mother , Run away I pray you Oh this is Counter you false Danish Dogges .</code></li>
</ul>
</section>
<section id="big-mcmc" class="level2">
<h2 class="anchored" data-anchor-id="big-mcmc">Big MCMC</h2>
<p>Can we augment memory?</p>
<ul>
<li>if you want to compute the most frequent letter (among <code>26</code>) after <code>50</code> letters, you need to take into account <code>5.6061847e+70</code> combinations !
<ul>
<li>impossible to store, let alone do the training</li>
</ul></li>
<li>but some combinations are useless:
<ul>
<li><code>wjai dfni</code></li>
<li><code>Despite the constant negative press covfefe</code> <span class="fragment">🤔</span></li>
</ul></li>
</ul>
</section>
<section id="reccurrent-neural-networks" class="level2">
<h2 class="anchored" data-anchor-id="reccurrent-neural-networks">Reccurrent Neural Networks</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img src="assets/glowing_nn.png" class="img-fluid"></p>
</div><div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/Recurrent_neural_network_unfold.svg.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Recurrent Neural Network</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Neural networks make it possible to increase the state-space to represent</p>
<p><span class="math display">\[\forall X, P(x_n=X| x_{n-1}, ..., x_{n-k})\]</span></p>
<p>they reduce endogenously the dimensionality.</p>
</section>
<section id="recurrent-neural-networks" class="level2">
<h2 class="anchored" data-anchor-id="recurrent-neural-networks">Recurrent Neural Networks</h2>
<p>In 2015</p>
<iframe width="780" height="500" src="http://karpathy.github.io/2015/05/21/rnn-effectiveness/" title="The unreasonable Effectiveness of Recurrent Neural Networks">
</iframe>
<ul>
<li><strong>Neural Network</strong> reduce dimensionality of data discovering structure</li>
</ul>
</section>
<section id="long-short-term-memory" class="level2">
<h2 class="anchored" data-anchor-id="long-short-term-memory">Long Short Term Memory</h2>
<p><img src="assets/Long_Short-Term_Memory.svg" class="img-fluid"></p>
<ul>
<li>2000-&gt;2019 : Emergence of Long Short Term Memory models
<ul>
<li><p>speech recognition</p></li>
<li><p>LSTM behind “Google Translate”, “Alexa”, …</p></li>
</ul></li>
</ul>
</section>
<section id="the-latest-transformer" class="level2">
<h2 class="anchored" data-anchor-id="the-latest-transformer">The Latest: Transformer</h2>
<div class="columns">
<div class="column">
<ol type="1">
<li>Position Encodings
<ul>
<li>model is not sequential anymore</li>
<li>tries to learn sequence</li>
</ul></li>
<li>Attention</li>
<li>Self-Attention</li>
</ol>
</div><div class="column">
<p><img src="assets/transformers.png" class="img-fluid"></p>
</div>
</div>
<p>Explanations <a href="https://towardsdatascience.com/transformers-141e32e69591">here</a> or <a href="https://blogs.nvidia.com/blog/2022/03/25/what-is-a-transformer-model/">here</a></p>
</section>
<section id="quick-summary" class="level2">
<h2 class="anchored" data-anchor-id="quick-summary">Quick summary</h2>
<ul>
<li>Language models
<ul>
<li>frequency tables</li>
<li>monte carlo markov chains</li>
<li>long-short-term memory (&gt;2000)</li>
<li>transformers (&gt;2018)</li>
</ul></li>
</ul>
<p>. . .</p>
<ul>
<li>Since 2010 main breakthrough came through the development of deep-learning techniques (software/hardware)</li>
<li>Recently, <em>models</em>/algorithms have improved tremendously</li>
</ul>
</section>
<section id="gpt3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="gpt3">GPT3</h2>
<p>Generative Pre-trained Transformer</p>
<ul>
<li>GPT1 (1018)
<ul>
<li>0.1 billion parameters</li>
<li>had to be fine-tuned to a particular problem</li>
<li>transfer learning (few shots learning)</li>
</ul></li>
<li>GPT2:
<ul>
<li>multitask</li>
<li>no mandatory fine tuning</li>
</ul></li>
<li>GPT3:
<ul>
<li>bigger: 175 billions parameters</li>
</ul></li>
<li><a href="https://openai.com/research/gpt-4">GPT4</a>:
<ul>
<li>even bigger: 1000 billions parameters</li>
<li>on your harddrive: 1Tb</li>
</ul></li>
</ul>
</section>
<section id="corpus" class="level2">
<h2 class="anchored" data-anchor-id="corpus">Corpus</h2>
<div class="columns">
<div class="column">
<p>GPT 3 was trained on</p>
<ul>
<li>CommonCrawl</li>
<li>WebText</li>
<li>Wikipedia</li>
<li>many books</li>
</ul>
<p>45 TB of data</p>
<ul>
<li>cured into ???</li>
</ul>
<p>Dataset (mostly) ends in 2021.</p>
</div><div class="column">
<p><img src="assets/matrix.gif" class="img-fluid"></p>
</div>
</div>
</section>
<section id="chat-gpt" class="level2">
<h2 class="anchored" data-anchor-id="chat-gpt">Chat GPT</h2>
<p>It is trivial to make a chatbot using GPT3.</p>
<p><a href="https://openai.com/blog/chatgpt">ChatGPT</a> is an interface on top of GPT3.5 (now GPT4) plus some fine-tuning.</p>
<ul>
<li>it keeps the context</li>
<li>has a consistent “personality”</li>
</ul>
</section>
<section id="the-relation-between-gpt-3-and-chatgpt" class="level2">
<h2 class="anchored" data-anchor-id="the-relation-between-gpt-3-and-chatgpt">The Relation between GPT-3 and ChatGPT</h2>
<p>Technical paper is not out, but we know the following:</p>
<ul>
<li>it is <em>fine-tuned</em> by interacting with <a href="https://time.com/6247678/openai-chatgpt-kenya-workers/">humans</a></li>
<li>it uses <em>reinforcement learning</em> to optimize learning</li>
<li>now based on GPT4</li>
</ul>
<p>Improvment goals:</p>
<ul>
<li>better alignment</li>
<li>less making up of facts</li>
</ul>
</section>
</section>
<section id="how-can-we-use-gpt3" class="level1">
<h1>How can we use GPT3</h1>
<section id="generate-text" class="level2">
<h2 class="anchored" data-anchor-id="generate-text">Generate Text</h2>
<div class="columns">
<div class="column">
<p>Would you use GPT3 to:</p>
<div class="incremental">
<ul class="incremental">
<li>write a paper?</li>
<li>quickly respond to an email</li>
<li>write the boring details of a paper</li>
<li>get some ideas?</li>
<li>help you structure a talk?</li>
</ul>
</div>
<p>There are several concerns…</p>
</div><div class="column">
<p><img src="assets/evil.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="the-quality-of-the-generated-text" class="level2">
<h2 class="anchored" data-anchor-id="the-quality-of-the-generated-text">The quality of the generated text</h2>
<div class="incremental">
<ul class="incremental">
<li><p>GPT-3 has the tendancy to <em>hallucinate</em> facts.</p>
<ul class="incremental">
<li>like kids who don’t distinguish facts and play</li>
</ul></li>
<li><p>This is being worked on:</p>
<ul class="incremental">
<li>GPT4: <em>Can you teach old dogs new tricks?</em> <span class="fragment">yes 🐕</span></li>
</ul></li>
<li><p>Still a problem for research</p></li>
<li><p>Possibly solved by mixing AI and traditional computing</p></li>
</ul>
</div>
</section>
<section id="ethical-concerns" class="level2">
<h2 class="anchored" data-anchor-id="ethical-concerns">Ethical Concerns</h2>
<p>We must avoid at all cost <em>plagiarism</em> and credit our sources.</p>
<p>We need personal ethics:</p>
<ul>
<li>give sources</li>
<li>mention use of GPT3 we we use it</li>
</ul>
</section>
<section id="replace-many-nlp-algorithms" class="level2">
<h2 class="anchored" data-anchor-id="replace-many-nlp-algorithms">Replace Many NLP Algorithms</h2>
<p>Beyond generating text, most Natural Language Processing tasks can be now done with GPT-3:</p>
<ul>
<li>Named entity recognition</li>
<li>Classification
<ul>
<li>sentiment analysis</li>
<li>multimodel sentiment analysis</li>
</ul></li>
<li>Entity linking</li>
<li>Summarization</li>
<li>Many <a href="https://platform.openai.com/examples">more</a></li>
</ul>
</section>
<section id="named-entity-recognition" class="level2">
<h2 class="anchored" data-anchor-id="named-entity-recognition">Named Entity recognition</h2>
<p>Prompt:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<pre><code>[Text]: Helena Smith founded Core.ai 2 years ago. She is now the CEO and CTO of the company and is building a team of highly skilled developers in machine learning and natural language processing.
[Position]: CEO and CTO
###
[Text]: Tech Robotics is a robot automation company specialized in AI driven robotization. Its Chief Technology Officer, Max Smith, says a new wave of improvements should be expected for next year.
[Position]: Chief Technology Officer
###
[Text]: François is a Go developer. He mostly works as a freelancer but is open to any kind of job offering!
[Position]: Go developer
###
[Text]: Maxime is a data scientist at Auto Dataset, and he's been working there for 1 year.
[Position]:</code></pre>
<p>. . .</p>
<p><code>Response: Data Scientist</code></p>
</section>
<section id="fine-tuning-1" class="level2">
<h2 class="anchored" data-anchor-id="fine-tuning-1">Fine-tuning (1)</h2>
<ul>
<li>To get better result, or to proceed larger amounts of data, pretrain the model</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>model.train(<span class="st">"""</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">"[Text]: Helena Smith founded Core.ai 2 years ago. She is now the CEO and CTO of the company and is building a team of highly skilled developers in machine learning and natural language processing.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">[Position]: CEO and CTO</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model.train(<span class="st">"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">[Text]: Tech Robotics is a robot automation company specialized in AI driven robotization. Its Chief Technology Officer, Max Smith, says a new wave of improvements should be expected for next year.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">[Position]: Chief Technology Officer</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="fine-tuning-2" class="level2">
<h2 class="anchored" data-anchor-id="fine-tuning-2">Fine-tuning (2)</h2>
<ul>
<li>Query the model:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">eval</span>(<span class="st">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">[Text]: Maxime is a data scientist at Auto Dataset, and he's been working there for 1 year.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">[Position]:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>…</p>
<pre><code>[Text]: Maxime is a data scientist at Auto Dataset, and he's been working there for 1 year.
[Position]: Data Scientist```</code></pre>
</section>
<section id="sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-analysis">Sentiment Analysis</h2>
<p>Zero-shot learning:</p>
<pre><code>Decide whether a Tweet's sentiment is positive, neutral, or negative.

Tweet: "I loved the new Batman movie!"
Sentiment:</code></pre>
<p>Output: <code>Positive</code></p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<section id="are-we-on-the-way-to-general-artificial-intelligence" class="level2">
<h2 class="anchored" data-anchor-id="are-we-on-the-way-to-general-artificial-intelligence">Are we on the way to General Artificial Intelligence?</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/benevolent_ai.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A Benevolent General Purpose Artificial Intelligence. Dall-E-2</figcaption><p></p>
</figure>
</div>
<p>. . .</p>
<p>My two cents:</p>
<p>. . .</p>
<ul>
<li>artificial intelligence is already there (we are fooling ourselves…)</li>
<li>are we ready for artificial humanity?</li>
</ul>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>here, plausible, means that it is more likely to be a correct text written by a human, rather than otherwise<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://towardsdatascience.com/advanced-ner-with-gpt-3-and-gpt-j-ce43dc6cdb9c<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>